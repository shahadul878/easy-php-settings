jQuery(document).ready(function($) {
    // Configuration Generator
    $('#generate-config').on('click', function() {
        var settings = {};
        if (window.easy_php_settingsKeys && Array.isArray(window.easy_php_settingsKeys)) {
            window.easy_php_settingsKeys.forEach(function(key) {
                var input = $('input[name="easy_php_settings_settings[' + key + ']"]');
                if (input.length && input.val()) {
                    settings[key] = input.val();
                }
            });
        }
        // Generate .user.ini content
        var userIniContent = '; PHP Settings generated by Easy PHP Settings plugin\n';
        userIniContent += '; Generated on: ' + new Date().toLocaleString() + '\n\n';
        Object.keys(settings).forEach(function(key) {
            userIniContent += key + ' = ' + settings[key] + '\n';
        });
        // Add custom php.ini config if present
        var customIni = $('#easy_php_settings_custom_php_ini');
        if (customIni.length && customIni.val().trim()) {
            userIniContent += '\n; Custom php.ini directives\n' + customIni.val().trim() + '\n';
        }
        // Generate .htaccess content
        var htaccessContent = '# PHP Settings generated by Easy PHP Settings plugin\n';
        htaccessContent += '# Generated on: ' + new Date().toLocaleString() + '\n\n';
        Object.keys(settings).forEach(function(key) {
            htaccessContent += 'php_value ' + key + ' ' + settings[key] + '\n';
        });
        // Add custom php.ini config as comments to .htaccess
        if (customIni.length && customIni.val().trim()) {
            htaccessContent += '\n# Custom php.ini directives\n';
            htaccessContent += customIni.val().trim().split('\n').map(function(line){ return '# ' + line; }).join('\n') + '\n';
        }
        $('#user-ini-content').val(userIniContent);
        $('#htaccess-content').val(htaccessContent);
        $('#config-output').show();
    });

    // Copy to clipboard
    window.copyToClipboard = function(elementId) {
        var textarea = document.getElementById(elementId);
        if (!textarea) return;
        textarea.select();
        document.execCommand('copy');
        alert(easy_php_settingsAdminVars.copiedText);
    };

    // Test Settings
    $('#test-settings').on('click', function() {
        var results = $('#test-results');
        results.html('<p>Testing settings...</p>');
        setTimeout(function() {
            results.html('<p style="color: green;">âœ“ ' + easy_php_settingsAdminVars.testCompleted + '</p>');
        }, 1000);
    });
}); 